#!/bin/sh
set -e

if [ $# -ge 1 ]; then
    max=$1
else
    max=1
fi
shift

flow --color=always "$@" | awk -v max=$max '
    BEGIN { num = 0; }
    /^([^[:space:]]+)(Error|Warning):/ { num++ }
    num <= max { print $0 }
'
